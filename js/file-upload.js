let dropArea=document.getElementById("drop-area");function preventDefaults(e){e.preventDefault(),e.stopPropagation()}function highlight(e){dropArea.classList.add("__highlight")}function unhighlight(e){dropArea.classList.remove("__active")}function handleDrop(e){handleFiles(e.dataTransfer.files)}["dragenter","dragover","dragleave","drop"].forEach(e=>{dropArea.addEventListener(e,preventDefaults,!1),document.body.addEventListener(e,preventDefaults,!1)}),["dragenter","dragover"].forEach(e=>{dropArea.addEventListener(e,highlight,!1)}),["dragleave","drop"].forEach(e=>{dropArea.addEventListener(e,unhighlight,!1)}),dropArea.addEventListener("drop",handleDrop,!1);let uploadProgress=[],progressBar=document.getElementById("progress-bar");function initializeProgress(e){progressBar.value=0,uploadProgress=[];for(let r=e;r>0;r--)uploadProgress.push(0)}function updateProgress(e,r){uploadProgress[e]=r;let t=uploadProgress.reduce((e,r)=>e+r,0)/uploadProgress.length;console.debug("update",e,r,t),progressBar.value=t}function handleFiles(e){initializeProgress((e=[...e]).length),e.forEach(uploadFile),e.forEach(previewFile)}function previewFile(e){let r=new FileReader;r.readAsDataURL(e),r.onloadend=function(){let e=document.createElement("img");e.src=r.result,document.getElementById("gallery").appendChild(e)}}function uploadFile(e,r){var t=new XMLHttpRequest,a=new FormData;t.open("POST","https://api.cloudinary.com/v1_1/kurjoz/tmp",!0),t.setRequestHeader("X-Requested-With","XMLHttpRequest"),t.upload.addEventListener("progress",(function(e){updateProgress(r,100*e.loaded/e.total||100)})),t.addEventListener("readystatechange",(function(e){4==t.readyState&&200==t.status?updateProgress(r,100):4==t.readyState&&t.status})),a.append("upload_preset","obanzopa"),a.append("file",e),t.send(a)}